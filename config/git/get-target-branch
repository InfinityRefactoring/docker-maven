#!/bin/bash

CURRENT_BRANCH="${1:-$CURRENT_BRANCH}"
DEVELOP_BRANCH_PATTERN="${DEVELOP_BRANCH_PATTERN:-"develop"}"
DEVELOP_BRANCH_PATTERN="${2:-$DEVELOP_BRANCH_PATTERN}"
FEATURE_BRANCH_PATTERN="${FEATURE_BRANCH_PATTERN:-"^feature.*"}"
FEATURE_BRANCH_PATTERN="${3:-$FEATURE_BRANCH_PATTERN}"
RELEASE_BRANCH_PATTERN="${RELEASE_BRANCH_PATTERN:-"^release.*"}"
RELEASE_BRANCH_PATTERN="${4:-$RELEASE_BRANCH_PATTERN}"
HOTFIX_BRANCH_PATTERN="${HOTFIX_BRANCH_PATTERN:-"^hotfix.*"}"
HOTFIX_BRANCH_PATTERN="${5:-$HOTFIX_BRANCH_PATTERN}"
PRODUCTION_BRANCH_PATTERN="${PRODUCTION_BRANCH_PATTERN:-"master"}"
PRODUCTION_BRANCH_PATTERN="${6:-$PRODUCTION_BRANCH_PATTERN}"

if [[ "$CURRENT_BRANCH" =~ $FEATURE_BRANCH_PATTERN ]]; then
    echo "$DEVELOP_BRANCH_PATTERN"
elif [[ "$CURRENT_BRANCH" =~ $DEVELOP_BRANCH_PATTERN ]] \
    || [[ "$CURRENT_BRANCH" =~ $RELEASE_BRANCH_PATTERN ]] \
    || [[ "$CURRENT_BRANCH" =~ $HOTFIX_BRANCH_PATTERN ]]; then
    echo "$PRODUCTION_BRANCH_PATTERN"
else
    echo "$CURRENT_BRANCH"
fi
